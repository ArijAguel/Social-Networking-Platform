<div [dir]="'dir'|translate" class="sticky-button" [ngClass]="{'left': ('dir'|translate)==='ltr', 'right': ('dir'|translate)==='rtl'}">
    <button *ngIf="isEditable" (click)="save() " class="btn btn-success btn-xl help"><i class="fa-solid fa-floppy-disk" style="font-size: 20px;cursor: pointer;"></i>&nbsp;&nbsp;{{'SAVE'|translate}}</button><br> <br>
</div>
<div class="col-12 d-flex align-items-center justify-content-center mt-4 ml-2">
    <img alt="" src="{{etape44.project.logo | defaultimage :etape44.project.name:'':true}}" class="size-20 rounded-lg object-contain shadow-sm mr-3" />
    <h1 class="text-center flex-grow-1">{{'MARKET_STUDY'|translate}}</h1>
</div>

<br>
<br>

<h4 *ngIf="isEditable" style="margin-left: 3%;position:relative;">
    {{'DOWNLOAD_MARKET_STUDY'|translate}} <a (click)="downloadPDF()" style="cursor: pointer;text-decoration: underline; font-weight: bold;">PDF</a> {{'OR'|translate}} <a style="cursor: pointer;text-decoration: underline; font-weight: bold;" (click)="downloadWord()">Word(.docs)</a>
</h4>
<form [formGroup]="etape4" (ngSubmit)="onSubmit()">
    <div class="main-conatiner" id="certificate">
        <h3 id="accordion-collapse-heading-1" style="font-size: 20px;;position:relative">
            <button type="button" class="flex items-center justify-between w-full px-2 rtl:text-right text-gray-500 border border-b-0 border-gray-200 rounded-xl hover:bg-gray-100 focus:ring-4  gap-3" (click)="toggleAccordion(1)">
        <h2>{{'I_ANALYSIS'|translate}} <i class="fa-regular fa-circle-question" style="font-size: 20px;cursor: pointer;" (click)="infoPreliminary()"></i></h2>
                <svg class="w-3 h-3 rotate-180 shrink-0" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5 5 1 1 5"/>
                </svg>
            </button>
        </h3>
        <div id="accordion-collapse-body-1" [ngClass]="{'hidden': !isOpen(1)}" class="p-5 border border-b-0 border-gray-200 rounded-xl mb-5">
            <div class="card mb-4 card-radius" style="border: none;">
                <div class="card-body px-0 pt-0 pb-2 card-shadow">
                    <h3>{{'OVERVIEW'|translate}}</h3>
                    <div class="form-dash">
                        <div class="form-group">
                            <label for="marcheCible">{{'WHO_ARE_YOUR_TARGET_CUSTOMERS'|translate}}</label>
                            <textarea dir="auto" type="text" formControlName="marcheCible" rows="3" class="form-control" name="marcheCible" required></textarea>
                        </div>
                    </div>
                    <div class="form-dash">
                        <div class="form-group">
                            <label for="descriptionProduit">{{'CUSTOMER_PROBLEM'|translate}}</label>
                            <textarea dir="auto" type="text" formControlName="descriptionProduit" rows="3" class="form-control" name="descriptionProduit" required></textarea>
                        </div>
                    </div>
                    <div class="form-dash">
                        <div class="form-group">
                            <label for="quelImpact">{{'SOLUTION_PROPOSAL'|translate}}</label>
                            <textarea dir="auto" type="text" formControlName="quelImpact" rows="3" class="form-control" name="quelImpact" required></textarea>
                        </div>
                    </div>

                    <div class="form-dash">
                        <div class="form-group">
                            <label for="politiquePrix">{{'IMPACT_SOLUTION'|translate}}</label>
                            <textarea dir="auto" type="text" formControlName="politiquePrix" rows="3" class="form-control" name="politiquePrix" required></textarea>
                        </div>
                    </div>
                    <div class="form-dash">
                        <br>
                        <h3>{{'SWOT_ANALYSIS'|translate}}</h3>
                        <p>{{'CONDUCT_SWOT_ANALYSIS'|translate}} </p>
                        <ul>
                            <li><span style="font-weight: bold;">- {{'SWOT_STRENGTHS'|translate}}:</span> {{'SWOT_STRENGTHS_DESC'|translate}}</li>
                            <li><span style="font-weight: bold;">- {{'SWOT_WEAKNESSES'|translate}} :</span> {{'SWOT_WEAKNESSES_DESC'|translate}}</li>
                            <li><span style="font-weight: bold;">- {{'SWOT_OPPORTUNITIES'|translate}} :</span> {{'SWOT_OPPORTUNITIES_DESC'|translate}}</li>
                            <li><span style="font-weight: bold;">- {{'SWOT_THREATS'|translate}} :</span> {{'SWOT_THREATS_DESC'|translate}}</li>
                        </ul>
                        <table class="table table-bordered">
                            <tbody>
                                <tr>
                                    <td>
                                        <div class="form-group">
                                            <label for="forces" style="color: black">{{'SWOT_STRENGTHS'|translate}}</label>
                                            <textarea dir="auto" type="text" formControlName="forces" rows="2" class="form-control" name="forces" required></textarea>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="form-group">
                                            <label for="faiblesses" style="color: black">{{'SWOT_WEAKNESSES'|translate}}</label>
                                            <textarea dir="auto" type="text" formControlName="faiblesses" rows="2" class="form-control" name="faiblesses" required></textarea>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div class="form-group">
                                            <label for="opportunites" style="color: black">{{'SWOT_OPPORTUNITIES'|translate}}</label>
                                            <textarea dir="auto" type="text" formControlName="opportunites" rows="2" class="form-control" name="opportunites" required></textarea>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="form-group">
                                            <label for="menaces" style="color: black">{{'SWOT_THREATS'|translate}}</label>
                                            <textarea dir="auto" type="text" formControlName="menaces" rows="2" class="form-control" name="menaces" required></textarea>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="form-dash">
                        <br>
                        <h3>{{'PESTEL_ANALYSIS'|translate}}</h3>
                        <p>{{'PESTEL_ANALYSIS_DESC'|translate}}</p>
                        <ul>
                            <li><span style="font-weight: bold;">- {{'PESTEL_POLITICAL'|translate}}</span> {{'PESTEL_POLITICAL_DESC'|translate}}</li>
                            <li><span style="font-weight: bold;">- {{'PESTEL_ECONOMIC'|translate}}</span> {{'PESTEL_ECONOMIC_DESC'|translate}}</li>
                            <li><span style="font-weight: bold;">- {{'PESTEL_SOCIAL'|translate}}</span> {{'PESTEL_SOCIAL_DESC'|translate}}</li>
                            <li><span style="font-weight: bold;">- {{'PESTEL_TECHNOLOGICAL'|translate}}</span>{{'PESTEL_TECHNOLOGICAL_DESC'|translate}}
                            </li>
                            <li><span style="font-weight: bold;">- {{'PESTEL_ENVIRONMENTAL'|translate}}</span> {{'PESTEL_ENVIRONMENTAL_DESC'|translate}}</li>
                            <li><span style="font-weight: bold;">- {{'PESTEL_LEGAL'|translate}}</span> {{'PESTEL_LEGAL_DESC'|translate}} </li>
                        </ul>
                        <table class="table table-bordered" formArrayName="pestel">
                            <thead>
                                <tr>
                                    <th scope="col" style="color: #c0aa81;">{{'PESTEL_AXES'|translate}}</th>
                                    <th scope="col" style="color: #c0aa81;">{{'PESTEL_STRONG_POINTS'|translate}}</th>
                                    <th scope="col" style="color: #c0aa81;">{{'PESTEL_WEAK_POINTS'|translate}}</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let pestelItem of pestel().controls; trackBy: trackById ; let i=index" [formGroupName]="i">
                                    <td>
                                        <div class="form-group">
                                            <input dir="auto" type="text" formControlName="axe" class="form-control">
                                        </div>
                                    </td>
                                    <td>
                                        <div class="form-group">
                                            <textarea dir="auto" formControlName="forces" class="form-control" rows="3"></textarea>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="form-group">
                                            <textarea dir="auto" formControlName="faiblesses" class="form-control" rows="3"></textarea>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                    </div>
                    <div class="form-dash">
                        <br>
                        <h3>{{'COMPETITIVE_ANALYSIS'|translate}} </h3>
                        <div class="card mb-4 card-radius" style="padding: 30px;">
                            <table class="table" formArrayName="comptitors">
                                <thead>
                                    <tr>
                                        <td style="color: #c0aa81;">{{'COMPETITOR'|translate}}</td>
                                        <td style="color: #c0aa81;">{{'TYPE'|translate}}</td>
                                        <td style="color: #c0aa81;">{{'MARKET_SHARE'|translate}} </td>
                                        <td style="color: #c0aa81;">{{'STRATEGIC_POSITIONING'|translate}} </td>
                                        <td style="color: #c0aa81;">{{'PRICING'|translate}}</td>
                                        <td style="color: #c0aa81;">{{'STRENGTHS'|translate}}</td>
                                        <td style="color: #c0aa81;">{{'WEAKNESSES'|translate}}</td>
                                        <td></td>
                                    </tr>
                                </thead>
                                <tr *ngFor="let val of Comptitor().controls; trackBy: trackById ; let i=index" [formGroupName]="i">
                                    <td [ngClass]="{'border-bottom': i < Comptitor().controls.length - 1}">
                                        <input maxlength="255" dir="auto" type="text" formControlName="comptitor" class="form-control">
                                    </td>
                                    <td [ngClass]="{'border-bottom': i < Comptitor().controls.length - 1}" style="width: 15%;">
                                        <select dir="auto" formControlName="type" class="form-select" required>
                                            <option selected value="Direct" data-twe-toggle="tooltip" data-twe-placement="right" data-twe-ripple-init data-twe-ripple-color="light" title="{{'DIRECT_COMPETITORS_DESCRIPTION'|translate}}">{{'DIRECT'|translate}}</option>
                                            <option value="Indirect" data-twe-toggle="tooltip" data-twe-placement="right" data-twe-ripple-init data-twe-ripple-color="light" title="{{'INDIRECT_COMPETITORS_DESCRIPTION'|translate}}">{{'INDIRECT'|translate}}</option>
                                        </select>
                                    </td>
                                    <td [ngClass]="{'border-bottom': i < Comptitor().controls.length - 1}">
                                        <input maxlength="255" dir="auto" type="text" formControlName="marketShare" class="form-control">
                                    </td>
                                    <td [ngClass]="{'border-bottom': i < Comptitor().controls.length - 1}">
                                        <input maxlength="255" dir="auto" type="text" formControlName="strategicPositioning" class="form-control">
                                    </td>
                                    <td [ngClass]="{'border-bottom': i < Comptitor().controls.length - 1}">
                                        <input maxlength="255" dir="auto" type="number" step="0.001" step="any" formControlName="pricing" class="form-control">
                                    </td>
                                    <td [ngClass]="{'border-bottom': i < Comptitor().controls.length - 1}">
                                        <input maxlength="255" dir="auto" type="text" formControlName="strengths" class="form-control">
                                    </td>
                                    <td [ngClass]="{'border-bottom': i < Comptitor().controls.length - 1}">
                                        <input maxlength="255" dir="auto" type="text" formControlName="weaknesses" class="form-control">
                                    </td>

                                    <td [ngClass]="{'border-bottom': i < Comptitor().controls.length - 1}">
                                        <i *ngIf="i > 0  && isEditable" (click)="removeComptitor(i)" class="fa-solid fa-trash" style="color: red; font-size: 25px;margin-top: 1px;"></i>
                                    </td>

                                </tr>
                            </table>
                            <button *ngIf="isEditable" type="button" class="btn btn-outline-primary startnow exclude-from-pdf" (click)="addComptitor('','','','',0,'','')">{{'ADD_A_COMPETITOR'|translate}}</button>
                        </div>
                        <div class="form-group">
                            <label for="positionnement">{{'STRATEGIC_POSITIONING_QUESTION'|translate}}</label>
                            <textarea dir="auto" type="text" formControlName="positionnement" rows="3" class="form-control" name="positionnement" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="concurrentiel">{{'COMPETITIVE_ADVANTAGES_TO_HIGHLIGHT'|translate}}</label>
                            <textarea dir="auto" type="text" formControlName="concurrentiel" rows="3" class="form-control" name="concurrentiel" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="oppMenaces">{{'OPPORTUNITIES_TO_BE_SEIZED'|translate}}</label>
                            <textarea dir="auto" type="text" formControlName="oppMenaces" rows="3" class="form-control" name="oppMenaces" required></textarea>
                        </div>
                    </div>
                </div>
            </div>
            <div>
                <div class="d-flex justify-content-around" style="position: relative;">
                    <button *ngIf="!isEditable&&canAddRemark" type="button" (click)="remarque('I_ANALYSIS')" class="btn btn-outline-primary noticed mt-2"><i class="fa-regular fa-lightbulb"></i> &nbsp; {{'ADD_REMARK'|translate}}</button>
                </div>
            </div>
        </div>


        <h3 id="accordion-collapse-heading-2" style="font-size: 20px;position:relative">
            <button type="button" class="flex items-center justify-between w-full px-2 hover:bg-gray-100 rtl:text-right text-gray-500 border border-b-0 border-gray-200 rounded-xl focus:ring-4  gap-3" (click)="toggleAccordion(2)">
                <h2>{{'II_STRATEGY'|translate}}<i class="fa-regular fa-circle-question" style="font-size: 20px;cursor: pointer;" (click)="infoPlan()"></i></h2>
                <svg class="w-3 h-3 rotate-180 shrink-0" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5 5 1 1 5"/>
                </svg>
            </button>
        </h3>
        <div id="accordion-collapse-body-2" [ngClass]="{'hidden': !isOpen(2)}" class="p-5 border border-b-0 border-gray-200 rounded-xl mb-5">
            <br>
            <div class="card mb-4 card-radius" style="border: none;">
                <div class="card-body px-0 pt-0 pb-2 card-shadow">
                    <div class="form-dash">
                        <h3>{{'STRATEGIC_POSITIONING'|translate}}</h3>
                        <div class="form-group">
                            <label for="size">{{'MARKET_SIZE'|translate}}</label>
                            <textarea dir="auto" type="text" formControlName="size" rows="3" class="form-control" name="size" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="advantages">{{'COMPETITIVE_ADVANTAGES_OPPORTUNITIES'|translate}}</label>
                            <textarea dir="auto" type="text" formControlName="advantages" rows="3" class="form-control" name="advantages" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="positioning">{{'POSITIONING_BASED_ON_ANALYSIS'|translate}}</label>
                            <textarea dir="auto" type="text" formControlName="positioning" rows="3" class="form-control" name="positioning" required></textarea>
                        </div>
                    </div>
                </div>
                <div class="form-dash">
                    <br>
                    <h3>{{'MARKETING_MIX'|translate}} </h3>
                    <p>{{'MARKETING_MIX_DESCRIPTION'|translate}}</p>

                    <div class="form-group">
                        <label for="product">{{'PRODUCT_DESCRIPTION'|translate}}</label>
                        <textarea dir="auto" type="text" formControlName="product" rows="3" class="form-control" name="product" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="price">{{'PRICE_DESCRIPTION'|translate}}</label>
                        <textarea dir="auto" type="text" formControlName="price" rows="3" class="form-control" name="price" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="place">{{'PLACE_DESCRIPTION'|translate}} </label>
                        <textarea dir="auto" type="text" formControlName="place" rows="3" class="form-control" name="place" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="promotion">{{'PROMOTION_DESCRIPTION'|translate}}</label>
                        <textarea dir="auto" type="text" formControlName="promotion" rows="3" class="form-control" name="promotion" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="people">{{'PEOPLE_DESCRIPTION'|translate}}</label>
                        <textarea dir="auto" type="text" formControlName="people" rows="3" class="form-control" name="people" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="process">{{'PROCESS_DESCRIPTION'|translate}}</label>
                        <textarea dir="auto" type="text" formControlName="process" rows="3" class="form-control" name="process" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="physical">{{'PHYSICAL_EVIDENCE_DESCRIPTION'|translate}}</label>
                        <textarea dir="auto" type="text" formControlName="physical" rows="3" class="form-control" name="physical" required></textarea>
                    </div>
                </div>
                <br>
                <div class="card-body px-0 pt-0 pb-2 card-shadow">
                    <div class="form-dash">
                        <h3>{{'MARKETING_OBJECTIVES'|translate}}</h3>
                        <p>{{'MARKETING_OBJECTIVES_DESCRIPTION'|translate}}</p>
                        <div class="card mb-4 card-radius" style="padding: 30px;">
                            <table class="table" formArrayName="marketingobjectivs">
                                <thead>
                                    <tr>
                                        <td style="color: #c0aa81;">{{'MARKETING_OBJECTIVES'|translate}}</td>
                                        <td style="color: #c0aa81;">{{'DEADLINE'|translate}}</td>
                                        <td></td>
                                    </tr>
                                </thead>
                                <tr *ngFor="let val of MarketingObjectivs().controls; trackBy: trackById ; let i=index" [formGroupName]="i">
                                    <td [ngClass]="{'border-bottom': i < MarketingObjectivs().controls.length - 1}">
                                        <input maxlength="255" dir="auto" type="text" formControlName="objectivs" class="form-control">
                                    </td>
                                    <td [ngClass]="{'border-bottom': i < MarketingObjectivs().controls.length - 1}">
                                        <input dir="auto" type="date" formControlName="deadline" class="form-control">
                                    </td>
                                    <td [ngClass]="{'border-bottom': i < MarketingObjectivs().controls.length - 1}">
                                        <i *ngIf="i > 0  && isEditable" (click)="removeMarketingObjectivs(i)" class="fa-solid fa-trash" style="color: red; font-size: 25px;margin-top: 1px;"></i>
                                    </td>

                                </tr>
                            </table>
                            <button *ngIf="isEditable" type="button" class="btn btn-outline-primary startnow exclude-from-pdf" (click)="addMarketingObjectivs('')">{{'ADD_MARKETING_OBJECTIVE'|translate}}</button>
                        </div>

                    </div>
                </div>
            </div>
            <div>
                <div class="d-flex justify-content-around" style="position: relative;">
                    <button *ngIf="!isEditable&&canAddRemark" type="button" (click)="remarque('II_STRATEGY')" class="btn btn-outline-primary noticed mt-2"><i class="fa-regular fa-lightbulb"></i> &nbsp; {{'ADD_REMARK'|translate}}</button>

                </div>
            </div>
        </div>


        <h3 id="accordion-collapse-heading-3" style="font-size: 20px;position:relative">
            <button type="button" class="flex items-center justify-between w-full px-2 hover:bg-gray-100 rtl:text-right text-gray-500 border border-b-0 border-gray-200 rounded-xl focus:ring-4  gap-3" (click)="toggleAccordion(3)">
                <h2>{{'III_IMPLEMENTATION_PLAN'|translate}} <i class="fa-regular fa-circle-question" style="font-size: 20px;cursor: pointer;" (click)="infoPlan()"></i></h2>
                <svg class="w-3 h-3 rotate-180 shrink-0" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5 5 1 1 5"/>
                </svg>
            </button>
        </h3>
        <div id="accordion-collapse-body-2" [ngClass]="{'hidden': !isOpen(3)}" class="p-5 border border-b-0 border-gray-200 rounded-xl mb-5">
            <div class="card mb-4 card-radius" style="border: none;">
                <div class="card-body px-0 pt-0 pb-2 card-shadow">
                    <div class="form-dash">
                        <p>{{'LIST_ACTIONS_REQUIRED'|translate}}</p>
                        <div class="card mb-4 card-radius" style="padding: 30px;">
                            <table class="table" formArrayName="marketings">
                                <thead>
                                    <tr>
                                        <td style="color: #c0aa81;">{{'ACTION'|translate}}</td>
                                        <td style="color: #c0aa81;">{{'RESPONSIBLES'|translate}}</td>
                                        <td style="color: #c0aa81;">{{'RESOURCES'|translate}}</td>
                                        <td style="color: #c0aa81;">{{'BUDGET'|translate}}</td>
                                        <td style="color: #c0aa81;">{{'DEADLINE'|translate}}</td>
                                        <td style="color: #c0aa81;">{{'KPIS'|translate}}</td>
                                        <td></td>
                                    </tr>
                                </thead>
                                <tr *ngFor="let val of Marketing().controls; trackBy: trackById ; let i=index" [formGroupName]="i">
                                    <td [ngClass]="{'border-bottom': i < Marketing().controls.length - 1}">
                                        <input maxlength="255" dir="auto" type="text" formControlName="action" class="form-control">
                                    </td>
                                    <td [ngClass]="{'border-bottom': i < Marketing().controls.length - 1}">
                                        <input maxlength="255" dir="auto" type="text" formControlName="responsables" class="form-control">
                                    </td>
                                    <td [ngClass]="{'border-bottom': i < Marketing().controls.length - 1}">
                                        <input maxlength="255" dir="auto" type="text" formControlName="resources" class="form-control">
                                    </td>
                                    <td [ngClass]="{'border-bottom': i < Marketing().controls.length - 1}">
                                        <input maxlength="255" dir="auto" type="text" formControlName="budget" class="form-control">
                                    </td>
                                    <td [ngClass]="{'border-bottom': i < Marketing().controls.length - 1}">
                                        <input maxlength="255" dir="auto" type="text" formControlName="deadline" class="form-control">
                                    </td>
                                    <td [ngClass]="{'border-bottom': i < Marketing().controls.length - 1}">
                                        <input maxlength="255" dir="auto" type="text" formControlName="kpis" class="form-control">
                                    </td>

                                    <td [ngClass]="{'border-bottom': i < Marketing().controls.length - 1}">
                                        <i *ngIf="i > 0  && isEditable" (click)="removeMarketing(i)" class="fa-solid fa-trash" style="color: red; font-size: 25px;margin-top: 1px;"></i>
                                    </td>

                                </tr>
                            </table>
                            <button *ngIf="isEditable" type="button" class="btn btn-outline-primary startnow exclude-from-pdf" (click)="addMarketing('','','','','','')">{{'ADD_MARKETING_OBJECTIVES'|translate}}</button>
                        </div>
                        <p>{{'CHECK_POINTS'|translate}}</p>
                        <div class="form-group">
                            <div>
                                <label>
                            <input dir="auto" class="custom-checkbox" type="checkbox" formControlName="objectifMarketing" > &nbsp; {{'VISION_MISSION_VALUES'|translate}}
                          </label>
                            </div>
                            <div>
                                <label>
                            <input dir="auto" class="custom-checkbox" type="checkbox" formControlName="longTerme" >  &nbsp; {{'LONG_TERM_GOALSQ'|translate}}
                          </label>
                            </div>
                            <div>
                                <label>
                            <input dir="auto" class="custom-checkbox" type="checkbox" formControlName="demarche" >  &nbsp; {{'SOCIAL_SOLIDARITY_APPROACH'|translate}}
                          </label>
                            </div>
                            <div>
                                <label>
                            <input dir="auto" class="custom-checkbox" type="checkbox" formControlName="smart" >  &nbsp; {{'SMART_OBJECTIVES'|translate}}
                          </label>
                            </div>
                            <div>
                                <label>
                              <input dir="auto" class="custom-checkbox" type="checkbox" formControlName="action" >  &nbsp;{{'COST_ESTIMATED'|translate}}
                            </label>
                            </div>
                            <div>
                                <label>
                              <input dir="auto" class="custom-checkbox" type="checkbox" formControlName="realisable" >  &nbsp; {{'RESPONSIBILITIES_ASSIGNED'|translate}}
                            </label>
                            </div>


                        </div>
                    </div>
                </div>
            </div>
            <div>
                <div class="d-flex justify-content-around" style="position: relative;">
                    <button *ngIf="!isEditable&&canAddRemark" type="button" (click)="remarque('III_IMPLEMENTATION_PLAN')" class="btn btn-outline-primary noticed mt-2"><i class="fa-regular fa-lightbulb"></i> &nbsp; {{'ADD_REMARK'|translate}}</button>

                </div>
            </div>
        </div>



        <h3 id="accordion-collapse-heading-4" style="font-size: 20px;position:relative">
            <button type="button" class="flex items-center justify-between w-full px-2 hover:bg-gray-100 rtl:text-right text-gray-500 border border-b-0 border-gray-200 rounded-xl focus:ring-4  gap-3" (click)="toggleAccordion(4)">
        <h2>{{'IV_SALES_FORECAST'|translate}} <i class="fa-regular fa-circle-question" style="font-size: 20px;cursor: pointer;" (click)="infoproducts()"></i></h2>
                <svg class="w-3 h-3 rotate-180 shrink-0" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5 5 1 1 5"/>
                </svg>
            </button>
        </h3>
        <div id="accordion-collapse-body-2" [ngClass]="{'hidden': !isOpen(4)}" class="p-5 border border-b-0 border-gray-200 rounded-xl mb-5">
            <br>
            <div class="card mb-4 card-radius" style="border: none;">

                <div class="card-body px-0 pt-0 pb-2 card-shadow">
                    <br>
                    <h3>{{'ANNUAL_SALES'|translate}}</h3>
                    <div class="card mb-4 card-radius" style="padding: 30px;">

                        <table class="table" formArrayName="produit">
                            <thead>
                                <tr>
                                    <td style="color: #c0aa81;">{{'PRODUCT_SERVICE'|translate}}</td>
                                    <td style="color: #c0aa81;">{{'UNIT_PRICE'|translate}} </td>
                                    <td style="color: #c0aa81;">{{'ESTIMATED_QUANTITY_ON_SALE_PER_YEAR'|translate}}</td>
                                    <td style="color: #c0aa81;">{{'TURNOVER_PER_PRODUCT'|translate}}</td>
                                    <td></td>
                                </tr>
                            </thead>
                            <tr *ngFor="let val of Produit().controls; trackBy: trackById ; let i=index" [formGroupName]="i">
                                <td [ngClass]="{'border-bottom': i < Produit().controls.length - 1}">
                                    <input dir="auto" type="text" formControlName="nom" class="form-control">
                                </td>
                                <td [ngClass]="{'border-bottom': i < Produit().controls.length - 1}">
                                    <input dir="auto" type="number" step="0.001" step="any" formControlName="prix" class="form-control" (input)="updateTotal(i)">
                                </td>
                                <td [ngClass]="{'border-bottom': i < Produit().controls.length - 1}">
                                    <input dir="auto" type="number" step="0.001" formControlName="quantite" class="form-control" (input)="updateTotal(i)">
                                </td>
                                <td [ngClass]="{'border-bottom': i < Produit().controls.length - 1}">
                                    <input dir="auto" type="number" step="0.001" step="any" formControlName="total" class="form-control">
                                </td>
                                <td [ngClass]="{'border-bottom': i < Produit().controls.length - 1}">
                                    <i *ngIf="i > 0  && isEditable" (click)="removeProduit(i)" class="fa-solid fa-trash" style="color: red; font-size: 25px;margin-top: 1px;"></i>
                                </td>
                            </tr>
                        </table>
                        <button *ngIf="isEditable" type="button" class="btn btn-outline-primary startnow exclude-from-pdf" (click)="addProduit('',0,0,0)">{{'ADD_A_PRODUCT'|translate}}</button>
                    </div>
                    <br>
                    <h4 style="color: gray;font-weight: bold;text-align: center;">{{'ANNUAL_TURNOVER'|translate}} {{cumulativeTotal}}</h4>
                </div>
            </div>
            <div>
                <div class="d-flex justify-content-around" style="position: relative;">
                    <button *ngIf="!isEditable&&canAddRemark" type="button" (click)="remarque('IV_SALES_FORECAST')" class="btn btn-outline-primary noticed mt-2"><i class="fa-regular fa-lightbulb"></i> &nbsp; {{'ADD_REMARK'|translate}}</button>
                </div>
            </div>
        </div>
    </div>
    <br>
    <br>
    <div class="flex justify-content-around" style="position:relative;">
        <button type="button" class="btn btn-outline-primary startnow"><a  [routerLink]="'/feed/etape/' + projectId + '/3'">{{'PREVIOUS_STEP'|translate}}</a></button>
        <button type="button" (click)="onSubmit()" class="btn btn-outline-primary startnow">{{'NEXT_STEP'|translate}}</button>
    </div>
</form>

<p-dialog [(visible)]="Preliminary" [modal]="true" [style]="{ width: '50vw', 'overflow':'hidden' }" [draggable]="false" [resizable]="false" [maximizable]="true">
    <h4 style="color: #c0aa81; text-align: center;font-size: 25px;font-weight: bold;">{{'PRELIMINARY_STUDY'|translate}}</h4>
    <div style="display: flex; justify-content: center; align-items: center; height: 100%;">
        <iframe width="560" height="315" [src]="videoUrls[0]" frameborder="0" allowfullscreen></iframe>
    </div>
</p-dialog>
<p-dialog [(visible)]="Plan" [modal]="true" [style]="{ width: '50vw', 'overflow':'hidden' }" [draggable]="false" [resizable]="false" [maximizable]="true">
    <h4 style="color: #c0aa81; text-align: center;font-size: 25px;font-weight: bold;">{{'MARKETING_PLAN'|translate}}</h4>
    <div style="display: flex; justify-content: center; align-items: center; height: 100%;">
        <iframe width="560" height="315" [src]="videoUrls[1]" frameborder="0" allowfullscreen></iframe>
    </div>
</p-dialog>
<p-dialog [(visible)]="Plan" [modal]="true" [style]="{ width: '50vw', 'overflow':'hidden' }" [draggable]="false" [resizable]="false" [maximizable]="true">
    <h4 style="color: #c0aa81; text-align: center;font-size: 25px;font-weight: bold;">{{'MARKETING_PLAN'|translate}}</h4>
    <div style="display: flex; justify-content: center; align-items: center; height: 100%;">
        <iframe width="560" height="315" [src]="videoUrls[2]" frameborder="0" allowfullscreen></iframe>
    </div>
</p-dialog>
<p-dialog [(visible)]="products" [modal]="true" [style]="{ width: '50vw', 'overflow':'hidden' }" [draggable]="false" [resizable]="false" [maximizable]="true">
    <h4 style="color: #c0aa81; text-align: center;font-size: 25px;font-weight: bold;">{{'MARKETING_OF_PRODUCTS'|translate}}</h4>
    <div style="display: flex; justify-content: center; align-items: center; height: 100%;">
        <iframe width="560" height="315" [src]="videoUrls[3]" frameborder="0" allowfullscreen></iframe>
    </div>
</p-dialog>
<p-dialog [(visible)]="showremarque" [modal]="true" [style]="{ width: '50vw', 'overflow':'hidden' }" [draggable]="false" [resizable]="false" [maximizable]="true">
    <h4 style="color: #c0aa81; text-align: center;font-size: 25px;font-weight: bold;">{{'REMARK'|translate}}</h4>
    <div class="d-flex flex justify-content-center" style="text-align: center;">
        <textarea dir="auto" #remarqueTextarea name="remarque" cols="50" rows="10" placeholder="{{'WRITE_REMARK'|translate}}" style="display: block;border-radius: 10px;border: 2px solid #c0aa81;"></textarea>
        <br>
    </div>
    <button type="button" class="btn btn-outline-primary startnow" style="display: block;" (click)="sendRemark(remarqueTextarea.value)">{{'SEND'|translate}}</button>
</p-dialog>
